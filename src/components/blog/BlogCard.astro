---
// src/components/blog/BlogCard.astro
// Created: Blog post card for listing pages

import Badge from '../ui/Badge.astro';
import Avatar from '../ui/Avatar.astro';
import { getAuthor } from '../../lib/blog-data';

interface Props {
  slug: string;
  title: string;
  excerpt: string;
  category: string;
  tags: string[];
  author: string;
  publishedAt: string;
  readingTime: number;
  image: string;
  imageAlt: string;
  featured?: boolean;
}

const { 
  slug, 
  title, 
  excerpt, 
  category, 
  tags,
  author: authorId, 
  publishedAt, 
  readingTime, 
  image, 
  imageAlt,
  featured = false 
} = Astro.props;

const author = getAuthor(authorId);

// Category color mapping
const categoryColors: Record<string, string> = {
  'digital-marketing': 'bg-blue-500/10 text-blue-600',
  'seo': 'bg-emerald-500/10 text-emerald-600',
  'web-development': 'bg-violet-500/10 text-violet-600',
  'social-media': 'bg-pink-500/10 text-pink-600',
  'ecommerce': 'bg-amber-500/10 text-amber-600',
  'design': 'bg-rose-500/10 text-rose-600',
  'business': 'bg-cyan-500/10 text-cyan-600',
};

// Format date
const formattedDate = new Date(publishedAt).toLocaleDateString('id-ID', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---

<article
  class:list={[
    'blog-card group relative rounded-2xl overflow-hidden',
    'bg-[color:var(--color-bg-primary)] border border-[color:var(--color-border)]',
    'hover:border-[color:var(--color-accent)]/30 hover:shadow-[var(--shadow-xl)]',
    'transition-all duration-300',
    featured && 'md:col-span-2 lg:col-span-2',
  ]}
>
  <a href={`/blog/${slug}`} class="block">
    {/* Image */}
    <div class:list={[
      'relative overflow-hidden',
      featured ? 'aspect-[16/9]' : 'aspect-[16/10]',
    ]}>
      {/* Placeholder gradient - replace with actual image */}
      <div class="absolute inset-0 bg-gradient-to-br from-[color:var(--color-bg-secondary)] to-[color:var(--color-bg-tertiary)]">
        <div class="w-full h-full flex items-center justify-center text-[color:var(--color-text-muted)]">
          <svg class="w-12 h-12 opacity-30" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
          </svg>
        </div>
      </div>
      
      {/* Uncomment when images are ready
      <img
        src={image}
        alt={imageAlt}
        class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
        loading="lazy"
        decoding="async"
      />
      */}

      {/* Category badge */}
      <div class="absolute top-4 left-4">
        <span class:list={[
          'px-3 py-1 text-xs font-medium rounded-full backdrop-blur-sm',
          categoryColors[category] || 'bg-gray-500/10 text-gray-600',
        ]}>
          {tags[0]}
        </span>
      </div>

      {/* Featured badge */}
      {featured && (
        <div class="absolute top-4 right-4">
          <Badge variant="primary" size="sm">Featured</Badge>
        </div>
      )}
    </div>

    {/* Content */}
    <div class="p-6">
      {/* Meta */}
      <div class="flex items-center gap-4 text-sm text-[color:var(--color-text-muted)] mb-3">
        <span>{formattedDate}</span>
        <span>â€¢</span>
        <span>{readingTime} min read</span>
      </div>

      {/* Title */}
      <h3 class:list={[
        'font-bold text-[color:var(--color-text-primary)] mb-2',
        'group-hover:text-[color:var(--color-accent)] transition-colors',
        'line-clamp-2',
        featured ? 'text-xl md:text-2xl' : 'text-lg',
      ]}>
        {title}
      </h3>

      {/* Excerpt */}
      <p class:list={[
        'text-[color:var(--color-text-tertiary)] mb-4 line-clamp-2',
        featured ? 'text-base' : 'text-sm',
      ]}>
        {excerpt}
      </p>

      {/* Author */}
      {author && (
        <div class="flex items-center gap-3 pt-4 border-t border-[color:var(--color-border)]">
          <Avatar
            name={author.name}
            src={author.avatar}
            size="sm"
          />
          <div>
            <p class="text-sm font-medium text-[color:var(--color-text-primary)]">
              {author.name}
            </p>
            <p class="text-xs text-[color:var(--color-text-muted)]">
              {author.role}
            </p>
          </div>
        </div>
      )}
    </div>
  </a>
</article>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  @media (prefers-reduced-motion: reduce) {
    .blog-card img {
      transition: none;
    }
    
    .blog-card:hover img {
      transform: none;
    }
  }
</style>